/*!
* Cyprus
*
* (c) Copyright mythemeshop.com
*
* @version 1.0.0
* @author  MyThemeShop
*/

!function($){$.fn.isOnScreen=function(){if(window){var win=$(window),viewport={top:win.scrollTop(),left:win.scrollLeft()},bounds=this.offset();return viewport.right=viewport.left+win.width(),viewport.bottom=viewport.top+win.height(),bounds.right=bounds.left+this.outerWidth(),bounds.bottom=bounds.top+this.outerHeight(),!(viewport.right<bounds.left||viewport.left>bounds.right||viewport.bottom<bounds.top||viewport.top>bounds.bottom)}},$.fn.reverse=[].reverse;var MTSOptions={changeWarn:!1,searched:!1,history:window.History,blue:{mts_primary_color:'#2196F3'},green:{mts_primary_color:'#a0ce4e'},red:{mts_primary_color:'#e10707'},light:{mts_header_bg_color:'#ffffff',mts_header_border_color:'#e8e8e8',mts_background:'#ffffff',mts_content_bg_color:'#ffffff',mts_sidebar_bg_color:'#ffffff',mts_footer_bg_color:'#263033',mts_footer_border_color:'#e0e1e5',mts_copyrights_border_color:'#e0e1e5',mts_form_bg_color:'#ffffff',mts_form_text_color:'#a8a6a6',mts_form_border_color:'#d2d2d2',mts_main_menu_bg_color:'#ffffff',mts_main_menu_border_color:'#e2e2e2',mts_mobile_menu_bg_color:'#f7f7f7'},dark:{mts_header_bg_color:'#29292a',mts_header_border_color:'#3e3e3e',mts_background:'#29292a',mts_content_bg_color:'#29292a',mts_sidebar_bg_color:'#29292a',mts_footer_bg_color:'#2d2d2d',mts_footer_border_color:'#403f3f',mts_copyrights_border_color:'#4b4c4d',mts_form_bg_color:'#3e3e3e',mts_form_text_color:'#cccccc',mts_form_border_color:'#212122',mts_main_menu_bg_color:'#ffffff',mts_main_menu_border_color:'#29292A',mts_mobile_menu_bg_color:'#3e3e3e'},init:function(){this.tabs(),this.loadLastTab(),this.footer(),this.searching(),this.colorScheme(),this.dependencyManager(),this.misc(),this.multiselect(),this.sidebars_helper()},dependencyManager:function(){function checkDependency($currentValue,$desiredValue,$comparison){var $passed=!1;return'=='===$comparison&&$currentValue==$desiredValue&&($passed=!0),'='===$comparison&&($currentValue=$desiredValue)&&($passed=!0),'>='===$comparison&&$currentValue>=$desiredValue&&($passed=!0),'<='===$comparison&&$currentValue<=$desiredValue&&($passed=!0),'>'===$comparison&&$currentValue>$desiredValue&&($passed=!0),'<'===$comparison&&$currentValue<$desiredValue&&($passed=!0),'!='===$comparison&&$currentValue!=$desiredValue&&($passed=!0),$passed}function loopDependencies($container){var passed,relation=$container.data('relation'),$table=$container.closest('.form-table');$container.find('span').each(function(){var $this=$(this),$value=$this.data('value'),$field=$this.data('field'),$comparison=$this.data('comparison');$field=$table.hasClass('mts-opts-group')?$("[name*='"+$field+"']",$table):$("[name*='"+$field+"']");var $fieldValue=$field.val();$field.is(':radio')&&($fieldValue=$field.filter(':checked').val());var result=checkDependency($fieldValue,$value,$comparison);if('or'===relation&&result)return passed=!0,!1;'and'===relation&&(passed=void 0===passed?result:passed&&result)}),passed?$container.closest('tr').fadeIn(300):$container.closest('tr').hide()}$('.cyprus-option-dependency').each(function(){loopDependencies($(this))});var $nots=$('input, select','.typography-controls');$('input, select','.mts-opts-group-tab').not($nots).on('change',function(){var $this=$(this),$table=$this.closest('.form-table'),$field=$this.data('id')||$this.attr('name');$field=$field.replace(mtsOptions.opt_name+'[','').replace(']',''),($table.hasClass('mts-opts-group-tab')?$('span[data-field="'+$field+'"]',$table):$('span[data-field="'+$field+'"]')).each(function(){loopDependencies($(this).closest('.cyprus-option-dependency'))})})},colorScheme:function(){var self=this;$('.buttonset #mts_theme_skin_0, .buttonset #mts_theme_skin_1').on('click',function(){var skin=$(this).val();skin='dark'===skin?self.dark:self.light;for(var id in skin)self.updateColor(id,skin[id])}),$('.mts-radio-img #mts_color_scheme_0, .mts-radio-img #mts_color_scheme_1, .mts-radio-img #mts_color_scheme_2').on('click',function(){var scheme=$(this).val();'blue'===scheme?scheme=self.blue:'green'===scheme?scheme=self.green:'red'===scheme&&(scheme=self.red);for(var id in scheme)self.updateColor(id,scheme[id])})},updateColor:function(id,hex){$('#colorpicker-'+id+' .wp-color-result').css('background-color',hex),$('#colorpicker-'+id+' .wp-color-picker').val(hex)},searching:function(){var self=this,div=$('.header-search'),input=div.find('input');input.on('keyup',function(event){var value=input.val().trim();return div.addClass('active'),27===event.keyCode||''===value?(self.clearSearch(!0),input.val(''),!1):(event.preventDefault(),self.searchOptions(value),!1)}).on('blur',function(){''===input.val().trim()&&div.removeClass('active')}),div.find('.dashicons-no').on('click',function(event){event.preventDefault(),self.clearSearch(!0),input.val(''),div.removeClass('active')})},searchOptions:function(query){var self=this,noresults=!0;self.searched=!0,query=query.toLowerCase(),$('.mts-opts-group-menu li.active').removeClass('active'),$('.mts-opts-info-field').hide(),$('#mts-opts-main').children('div').hide().each(function(){if('typography_section_group'===this.id)return!0;var $contents=$(this);$contents.children('table').children('tbody').children('tr').each(function(){var $row=$(this);$row.hide(),-1!==$row.find('th').text().toLowerCase().indexOf(query)&&($contents.show(),$row.show(),noresults=!1)}).reverse().each(function(){$(this).is(':visible')&&$(this).find('.buttonset-hide').length&&$(this).find('#mts-opts-button-show-below').each(function(){var num=$(this).parent().data('hide');$(this).hasClass('ui-state-active')?$(this).closest('tr').nextAll('tr:lt('+num+')').show():$(this).closest('tr').nextAll('tr:lt('+num+')').hide()})})}),noresults&&$('#options-search-no-results').show()},clearSearch:function(clickTab){var self=this;if(!self.searched)return!1;if($('#mts-opts-main').children().each(function(){$(this).find('tr').show().reverse().each(function(){$(this).find('.buttonset-hide').length&&$(this).find('#mts-opts-button-show-below').each(function(){var num=$(this).parent().data('hide');$(this).hasClass('ui-state-active')?$(this).closest('tr').nextAll('tr:lt('+num+')').show():$(this).closest('tr').nextAll('tr:lt('+num+')').hide()})})}),$('.mts-opts-info-field').show(),clickTab){var lastTab=$('#last_tab').val();'0'===lastTab?$('li:first','#mts-opts-group-menu').trigger('click'):$('#'+lastTab).trigger('click')}else $('input','.header-search').val('').parent().removeClass('active');self.searched=!1},footer:function(){var $footer=$('#mts-opts-footer'),footerPadding=$footer.innerWidth()-$footer.width();$footer.width($('.mts-opts-form-wrapper').width()-footerPadding);var stickMe=function(){$('#mts-opts-bottom').isOnScreen()?$footer.removeClass('floating'):$footer.addClass('floating')};stickMe(),$(window).on('scroll',function(){stickMe()}).on('resize',function(){$footer.width($('.mts-opts-form-wrapper').width()-footerPadding)})},misc:function(){var self=this;$('td','.mts-type-heading').attr('colspan','2'),$('#mts-opts-form-wrapper').submit(function(){var currentTab=$('#mts-opts-group-menu li.active:last').attr('id');$('#last_tab').val(currentTab),$('.typography-controls.collection-template').remove(),self.changeWarn=!1});var optsSave=$('.mts-opts-save');optsSave.is(':visible')&&optsSave.delay(4e3).slideUp('slow');var optsImported=$('.mts-opts-imported');optsImported.is(':visible')&&optsImported.delay(4e3).slideUp('slow'),$('input, textarea, select','#mts-opts-form-wrapper').on('change',function(){self.changeWarn||($('.mts-opts-save-warn').slideDown('slow'),self.changeWarn=!0)}),window.onbeforeunload=function(){if(self.changeWarn)return mtsOptions.leave_page_confirm},$('#mts-opts-footer .button-secondary').click(function(){return confirm(mtsOptions.reset_confirm)}),$('#mts-opts-form-wrapper').find('input').keydown(function(event){13===event.keyCode&&event.preventDefault()})},multiselect:function(){$('.search_select').select2(),$(document).on('click','.select_all',function(event){var $this=$(event.target),$select=$this.closest('td').find('select');$this.data('checked')?($select.find('option').removeAttr('selected'),$select.trigger('change'),$this.val('Select all'),$this.data('checked',0)):($select.find('option').prop('selected','selected'),$select.trigger('change'),$this.val('Clear all'),$this.data('checked',1))})},tabs:function(){var self=this,lis=$('li','#mts-opts-group-menu');lis.click(function(){var $this=$(this),target=$this.attr('id');if($this.hasClass('has-child'))return void $this.find('.submenu a:first').trigger('click');self.clearSearch(),$('#last_tab').val(target),lis.removeClass('active'),$this.closest('.has-child').addClass('active'),$this.addClass('active'),$('.mts-opts-group-tab').hide(),$('#'+target+'_section_group').show();var pageURL=$('[name="_wp_http_referer"]').val(),newURL=-1===pageURL.indexOf('tab=')?pageURL+'&tab='+target:pageURL;return self.history.pushState({tab:target},document.title,newURL),!1})},loadLastTab:function(){var self=this,lis=$('li','#mts-opts-group-menu');lis.removeClass('active'),$('.mts-opts-group-tab').hide();var lastTab=$('#last_tab').val();'0'===lastTab?lis.eq(0).trigger('click'):$('#'+lastTab).trigger('click'),self.history.Adapter.bind(window,'load statechange',function(){var state=self.history.getState(),tab=state.data.tab;void 0!==tab&&$('#'+tab).trigger('click')})},scrollImportLogToBottom:function(){var element=document.getElementById('importing-modal-content');element.scrollTop=element.scrollHeight},removeURLParameter:function(url,parameter){var urlparts=url.split('?');if(urlparts.length>=2){for(var prefix=encodeURIComponent(parameter)+'=',parts=urlparts[1].split(/[&;]/g),i=parts.length;i-- >0;)-1!==parts[i].lastIndexOf(prefix,0)&&parts.splice(i,1);url=urlparts[0]+'?'+parts.join('&')}return url},sidebars_helper:function(){$('#sidebars-general_section_group').length&&$('#sidebars-general_section_group').on('input','#mts_custom_sidebar_name',function(){var $id_field=$(this).closest('tr').next('tr').find('#mts_custom_sidebar_id');'1'!=$id_field.data('value_changed')&&$id_field.val(MTSOptions.slugify($(this).val()))}).on('input','#mts_custom_sidebar_id',function(){$(this).data('value_changed','1')})},slugify:function(text){return text.toString().toLowerCase().replace(/\s+/g,'-').replace(/[^\w\-]+/g,'').replace(/\-\-+/g,'-').replace(/^-+/,'').replace(/-+$/,'')}};$(document).ready(function(){MTSOptions.init()}),$(window).on('load',function(){$('#savechanges').prop('disabled',!1)})}(jQuery),function($){'use strict';if('ace'in window){var selector=$(document).find('.ace-wrapper');$(selector).each(function(){$(this).find('.ace-editor').each(function(index,element){var area=element,params=JSON.parse($(this).parent().find('.localize_data').val()),editor=$(element).attr('data-editor'),aceeditor=ace.edit(editor);aceeditor.setTheme('ace/theme/'+jQuery(element).attr('data-theme')),aceeditor.getSession().setMode('ace/mode/'+$(element).attr('data-mode')),aceeditor.setOptions(params),aceeditor.setShowPrintMargin(!1),aceeditor.on('change',function(){$('#'+area.id).val(aceeditor.getSession().getValue()),aceeditor.resize()})})})}}(jQuery),function($){$(document).ready(function(){void 0!==$.fn.buttonset&&$('.buttonset').buttonset(),$('.buttonset-tabs').each(function(){var $this=$(this),target='#'+$this.find('input[type=radio]:checked').attr('id')+'_tab';$this.closest('.bg-opt-wrapper').find(target).addClass('active-tab')}),$('.buttonset-tab').on('click',function(){var $this=$(this),target='#'+$this.prev().attr('id')+'_tab';$this.closest('.bg-opt-wrapper').find('.active-tab').removeClass('active-tab'),$this.closest('.bg-opt-wrapper').find(target).addClass('active-tab')})})}(jQuery),function($){$(document).ready(function(){$('input.popup-colorpicker').not($('input.popup-colorpicker','.mts-opts-dummy')).wpColorPicker()})}(jQuery),function($){$(document).ready(function(){$.isFunction($.fn.datepicker)&&$('.mts-opts-datepicker').datepicker()})}(jQuery),function($){$(document).ready(function(){if(void 0!==$.fn.accordion){var dragged=!1;$('div[id=mts-opts-groups-accordion] > div > h3').click(function(event){dragged&&(event.stopImmediatePropagation(),event.preventDefault(),dragged=!1)}),$('.mts-opts-groups-accordion-group').each(function(){var $this=$(this);if(!$this.is('.mts-opts-dummy')){var $header=$('h3 > span',$this),$firstField=$('textarea, input[type=text], select',this).first(),groupHeader='';groupHeader=void 0===$firstField?'':$firstField.is('select')?$firstField.find('option:selected').text():$firstField.val(),groupHeader=groupHeader.length>0?groupHeader.substring(0,32):$this.siblings('.mts-opts-dummy').find('.mts-opts-groups-header').text(),$header.text(groupHeader)}}),$('div[id=mts-opts-groups-accordion]').accordion({header:'> div > h3',collapsible:!0,active:!1,heightStyle:'content',icons:{header:'ui-icon-plus',activeHeader:'ui-icon-minus'},activate:function(event,ui){var $firstField=ui.oldPanel.find('textarea, input[type=text], select').first(),groupHeader='';void 0!==(groupHeader=void 0===$firstField?'':$firstField.is('select')?$firstField.find('option:selected').text():$firstField.val())&&groupHeader.length>0&&(groupHeader=groupHeader.substring(0,32),ui.oldHeader.find('.mts-opts-groups-header').text(groupHeader))}}).sortable({axis:'y',handle:'h3',stop:function(event,ui){ui.item.children('h3').triggerHandler('focusout'),$('input.group-sort').each(function(idx){$(this).val(idx)}),dragged=!0,setTimeout(function(){dragged=!1},100)}}),$('.mts-opts-groups-remove').on('click',function(){$(this).parent().parent().slideUp('medium',function(){$(this).remove()})}),$('.mts-opts-groups-close').on('click',function(){$(this).closest('.mts-opts-groups-accordion-group').find('h3').trigger('click')}),$('.mts-opts-groups-add').on('click',function(){var $this=$(this),newGroup=$this.prev().find('.mts-opts-dummy').clone(!0).show(),groupCounter=$this.parent().find('.mts-opts-dummy-group-count'),groupCount=groupCounter.val();groupCounter.val(parseInt(groupCount)+1),$this.prev().append(newGroup),newGroup=$(newGroup),newGroup.removeClass('mts-opts-dummy'),newGroup.find('input[type="radio"]').each(function(){var $that=$(this),attrName=$that.data('name'),attrID=$that.attr('id');void 0!==attrID&&!1!==attrID&&$that.attr('id',$that.attr('id').replace('dummy',groupCount)),void 0!==attrName&&!1!==attrName&&$that.attr('name',attrName.replace('@',groupCount));var label=$that.parent('label');label.attr('for',label.attr('for').replace('dummy',groupCount))}),newGroup.find('input[type="text"], input[type="number"], input[type="hidden"], textarea , select').each(function(){var $that=$(this),attrName=$that.data('name'),attrID=$that.attr('id'),stdVal=$that.data('std');void 0!==attrID&&!1!==attrID&&$that.attr('id',$that.attr('id').replace('@',groupCount)),void 0!==attrName&&!1!==attrName&&$that.attr('name',attrName.replace('@',groupCount)),'SELECT'===$that.prop('tagName')?($that.select2('destroy'),$that.next('.select2-container').remove(),$that.removeClass('select2-hidden-accessible'),$that.off('select2:select'),$that.find('option[value="'+stdVal+'"]').prop('selected',!0)):$that.val(stdVal),$that.hasClass('popup-colorpicker')&&$that.wpColorPicker(),$that.hasClass('mts-opts-iconselect')&&$that.select2({templateResult:function(item){return item.id?'<i class="fa fa-'+item.id+'"></i>&nbsp;&nbsp;'+item.text:item.text},templateSelection:function(item){return item.id?'<i class="fa fa-'+item.id+'"></i>&nbsp;&nbsp;'+item.text:item.text},escapeMarkup:function(m){return m}}),($that.hasClass('mts-opts-cats_multi_select')||$that.hasClass('search_select'))&&$that.select2(),$that.hasClass('group-sort')&&$that.val(groupCount)}),$(newGroup).find('h3').trigger('click')}),$('.mts-opts-dummy .mts-opts-upload-remove').trigger('click')}})}(jQuery),function($){$(document).ready(function(){var $nots=$('.mts-opts-iconselect','.mts-opts-dummy ');$('.mts-opts-iconselect').not($nots).select2({templateResult:function(item){return item.id?'<i class="fa fa-'+item.id+'"></i>&nbsp;&nbsp;'+item.text:item.text},templateSelection:function(item){return item.id?'<i class="fa fa-'+item.id+'"></i>&nbsp;&nbsp;'+item.text:item.text},escapeMarkup:function(m){return m}})})}(jQuery),function($){$(document).ready(function(){$('.mts-opts-sorter').each(function(){var id=$(this).attr('id');$(this).find('ul').sortable({items:'li',placeholder:'placeholder',connectWith:'.sortlist_'+id,opacity:.6,update:function(){$(this).find('.position').each(function(){var $this=$(this),listID=$this.parent().attr('id'),parentID=$this.parent().parent().attr('id');parentID=parentID.replace(id+'_','');var optionID=$this.parent().parent().parent().attr('id'),fieldName=$this.attr('name').replace(/\[.*\]/,'');$this.prop('name',fieldName+'['+optionID+']['+parentID+']['+listID+']')})}})})})}(jQuery),function($){$(document).ready(function(){$('.mts-opts-sorter-alt').each(function(){var id=$(this).attr('id');$(this).find('.sortlist-alt').sortable({items:'> .sortee-alt',handle:'.sortee-header',placeholder:'placeholder',connectWith:'.sortlist_'+id,opacity:.6,update:function(){$(this).find('.position-alt').each(function(){var $this=$(this),listID=$this.parent().attr('id'),parentID=$this.parent().parent().attr('id');parentID=parentID.replace(id+'_','');var optionID=$this.parent().parent().parent().attr('id'),fieldName=$this.attr('name').replace(/\[.*\]/,'');$this.prop('name',fieldName+'['+optionID+']['+parentID+']['+listID+']')})},start:function(event,ui){'block'===ui.item.find('.sortee-content').css('display')&&ui.item.css('height','40px'),$(this).sortable('refreshPositions')}})});var header=$('.sortee-has-content .sortee-header');header.prepend('<span class="ui-icon ui-icon-plus sortee-toggle"></span>'),header.on('click',function(){var $this=$(this);$this.next('.sortee-content').slideToggle(),$this.find('.sortee-toggle').toggleClass('ui-icon-minus ui-icon-plus')}),$('.mts-opts-sortee-toggle-close').on('click',function(){$(this).closest('.sortee-alt').find('.sortee-header').trigger('click')})})}(jQuery),function($){$(document).ready(function($){$('.mts-radio-img').on('click','label',function(){var $this=$(this);$this.siblings().removeClass('mts-radio-img-selected'),$this.addClass('mts-radio-img-selected')})})}(jQuery),function($){$(document).ready(function(){void 0!==mtsOptions.mtsGoogleFonts&&void 0!==mtsOptions.mtsGoogleFonts.generatePreview&&(window.typographyPreview=function(selector){var parent=selector.closest('.typography-controls'),family=$('.typography-family',parent).val(),familyBackup=$('.typography-family-backup',parent).val(),weight=$('.typography-font-weight',parent).val(),style=$('.typography-font-style',parent).val(),additional=$('.typography-additional-css',parent).val(),dropdown=parent.find('.typography-variant'),google=!0,variants=null,html='<option value=""></option>',selected='';'normal'===weight&&(weight='400');var variant=weight+style;if(null!==family&&void 0!==family||(family=familyBackup,google=!1),variants=family in mtsOptions.mtsGoogleFonts.googleFonts?mtsOptions.mtsGoogleFonts.googleFonts[family].variants:[{id:'400',name:'Normal 400'},{id:'400italic',name:'Normal 400 Italic'},{id:'700',name:'Bold 700'},{id:'700italic',name:'Bold 700 Italic'}],$.each(variants,function(index,item){variant===item.id?(selected=' selected="selected"',variant=item.id):selected='',html+='<option value="'+item.id+'"'+selected+'>'+item.name.replace(/\+/g,' ')+'</option>'}),dropdown.select2('destroy'),dropdown.html(html),dropdown.select2({allowClear:!0}),parent.hasClass('do-preview')){var preview=$('.preview_text',parent),color=$('.typography-color',parent).val(),size=$('.typography-font-size',parent).val(),height=$('.typography-line-height',parent).val(),letter=$('.typography-letter-spacing',parent).val(),marginTop=$('.typography-margin-top',parent).val(),marginBottom=$('.typography-margin-bottom',parent).val();if(null!==family&&'inherit'!==family){var theFont=family.replace(/\s+/g,'+');google&&(variant&&''!==variant&&(theFont+=':'+variant.replace(/\-/g,' ')),$('head').append('<link href="//fonts.googleapis.com/css?family='+theFont+'" rel="stylesheet">'))}if(preview.removeAttr('style'),color&&preview.css('color',color),size&&preview.css('font-size',size),weight&&preview.css('font-weight',weight),style&&preview.css('font-style',style),height&&preview.css('line-height',height),letter&&preview.css('letter-spacing',letter),marginTop&&preview.css('margin-top',marginTop),marginBottom&&preview.css('margin-bottom',marginBottom),additional&&(additional=preview.attr('style')+additional,preview.attr('style',additional)),null===family&&(family=''),-1!==family.indexOf(',')){family=family.split(',');for(var i=0;i<family.length;i++)family[i]=family[i].trim(),family[i]=family[i].split('"').join(''),family[i]=family[i].split('\'').join(''),-1!==family[i].indexOf(' ')&&(family[i]='"'+family[i]+'"');family=family.join(', ')}else family=family.trim(),family=family.split('"').join(''),family=family.split('\'').join(''),-1!==family.indexOf(' ')&&(family='"'+family+'"');preview.css('font_family',family+', sans-serif'),'none'===family&&''===family&&preview.css('font_family','inherit')}},window.initTypography=function(parent){parent.find('.typography-color').wpColorPicker({change:function(e,ui){$(this).val(ui.color.toString()),typographyPreview($(this))}}),parent.find('.typography-font-size, .typography-line-height, .typography-letter-spacing, .typography-margin-top, .typography-margin-bottom, .typography-additional-css').keyup(function(){typographyPreview($(this))}),parent.find('.typography-family-backup').select2({allowClear:!0}).on('select2:select',function(){typographyPreview($(this))}),parent.find('.typography-variant').select2().on('select2:select',function(){var $this=$(this),value=$this.val();$('.typography-font-style',parent).val(value.includes('italic')?'italic':''),$('.typography-font-weight',parent).val(parseInt(value)),typographyPreview($this)}),$.fn.select2.amd.require(['select2/data/array','select2/utils'],function(ArrayAdapter,Utils){function LazyAdapter($element,options){this.lazyOptions=$.extend({},options.get('lazy'),!0),this.lazyOptions.pageSize=this.lazyOptions.pageSize||30,this.lazyOptions.data=this.lazyOptions.data||[],ArrayAdapter.__super__.constructor.call(this,$element,options)}Utils.Extend(LazyAdapter,ArrayAdapter),LazyAdapter.prototype._genPaginatedData=function(data,params){var page=params.page||1,term=params.term||'',pageSize=this.lazyOptions.pageSize,_items=[];try{_items=data.filter(function(item){return 0<=item.text.toLowerCase().indexOf(term.toLowerCase())})}catch(e){}return{items:_items.slice((page-1)*pageSize,page*pageSize),totalCount:_items.length}},LazyAdapter.prototype._formatPaginatedResult=function(data,params){return params.page=params.page||1,{results:data.items,pagination:{more:params.page*this.lazyOptions.pageSize<data.totalCount},more:params.page*this.lazyOptions.pageSize<data.totalCount}},LazyAdapter.prototype.query=function(params,callback){var data=this._genPaginatedData(this.lazyOptions.data,params);callback(this._formatPaginatedResult(data,params))},parent.find('.typography-family').select2({allowClear:!0,ajax:{},lazy:{data:mtsOptions.mtsGoogleFonts.fonts,pageSize:20},dataAdapter:LazyAdapter,dropdownCssClass:'typography-family-select2',templateResult:function(item){return $(void 0!==item.id&&item.hasPreview?'<span class="has-preview" style="background-image: url('+mtsOptions.mtsGoogleFonts.previewUrl+item.hasPreview+'.png)"></span>':'<span class="no-preview">'+item.text+'</span>')}}).on('select2:select',function(){typographyPreview($(this))})}),typographyPreview(parent.find('.typography-family'))},$('.typography-preview-color').on('click','a',function(event){event.preventDefault();var $this=$(this),parent=$this.parent().parent();$this.hasClass('dark')?parent.addClass('dark'):parent.removeClass('dark'),parent.prev('input').val($this.attr('class'))}),$('.typography-controls:not(.collection-template)').each(function(){initTypography($(this))}),$(window).on('load',function(){if(''===mtsOptions.mtsGoogleFonts.generatePreview)return!1;setTimeout(function(){var count=0,fonts={};$.each(mtsOptions.mtsGoogleFonts.fonts,function(){if(10===count)return $.ajax({url:ajaxurl,method:'post',dataType:'json',data:{action:'mts_generate_font_preview',fonts:fonts}}),!1;if(!this.hasPreview){var id=this.id.toLowerCase().replace(/ /g,'');fonts[id]=this.text,count++}}),Object.keys(fonts).length&&$.ajax({url:ajaxurl,method:'post',dataType:'json',data:{action:'mts_generate_font_preview',fonts:fonts}})},3e3)}))})}(jQuery),function($){$(document).ready(function(){var collection=$('.typography-collections');collection.on('click','.typography-new-collection',function(event){event.preventDefault();var clone=collection.find('.collection-template').clone(),count=parseInt(collection.data('count'))+1;collection.data('count',count),clone.find('input, select, textarea').each(function(){var $this=$(this),oldName=$this.attr('name');void 0!==oldName&&$this.attr('name',oldName.replace('@',count))}),collection.append(clone),clone.removeClass('collection-template'),initTypography(clone)}),collection.on('click','.typography-remove-collection',function(event){event.preventDefault(),$(this).closest('.typography-controls').remove()})})}(jQuery),function($){$(document).ready(function(){if(void 0!==wp.media){var fileFrame,imageData,relid,$context;fileFrame=wp.media.frames.fileFrame=wp.media({title:mtsOptions.uploadTitle,button:{text:mtsOptions.uploadButtonText},multiple:!1}),fileFrame.on('select',function(){var $field=$('#'+relid,$context),$img=$field.next();imageData=fileFrame.state().get('selection').first().toJSON(),$field.val('id'===$img.data('return')?imageData.id:imageData.url).trigger('change'),$img.attr('src',imageData.url),$field.next().next().hide(),$field.next().next().next().show()}),$('img[src=""]').attr('src',mtsOptions.uploadUrl),$('#mts-opts-form-wrapper').on('click','.mts-opts-upload',function(event){event.preventDefault();var $this=$(this);$context=$this.parent(),relid=$this.attr('rel-id'),fileFrame.open()}),$('#mts-opts-form-wrapper').on('click','.mts-opts-upload-remove',function(){var $this=$(this),relid=$this.attr('rel-id');$('#mts-opts-screenshot-'+relid).attr('src',mtsOptions.uploadUrl),$('#'+relid).val(''),$('.mts-opts-upload[rel-id='+relid+']').show(),$this.hide(),$this.prev().prev().attr('src',mtsOptions.uploadUrl)})}})}(jQuery);